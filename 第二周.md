# æ·±å…¥äº†è§£ Git ç”¨æ³• - ç¬¬äºŒå‘¨

> å†¬æ—

- åˆ†æ”¯ä»‹ç»
- git checkout --branch
- git merge
- git rebase (åŒ…å« git rebase -i)

## Git moji è®©æ¯ä¸€æ¬¡æäº¤éƒ½å……æ»¡æ´»åŠ›:tada::tada::tada:

[gitmoji å®˜ç½‘](https://gitmoji.carloscuesta.me/)

## åˆ†æ”¯åŸºç¡€çŸ¥è¯†

åœ¨è¿›è¡Œæäº¤æ“ä½œæ—¶ï¼Œ Git ä¼šä¿å­˜ä¸€ä¸ªæäº¤å¯¹è±¡ï¼ˆcommit objectï¼‰
ä¸€ä¸ªæäº¤ä¿¡æ¯åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š
- ä½œè€…çš„å§“åå’Œé‚®ç®±
- æäº¤æ—¶è¾“å…¥çš„ä¿¡æ¯ï¼ˆcommit messageï¼‰
- æŒ‡å‘å®ƒçš„çˆ¶å¯¹è±¡çš„æŒ‡é’ˆï¼ˆ```é¦–æ¬¡æäº¤äº§ç”Ÿçš„æäº¤å¯¹è±¡æ²¡æœ‰çˆ¶å¯¹è±¡ï¼Œæ™®é€šæäº¤æ“ä½œäº§ç”Ÿçš„æäº¤å¯¹è±¡æœ‰ä¸€ä¸ªçˆ¶å¯¹è±¡ï¼Œ è€Œç”±å¤šä¸ªåˆ†æ”¯åˆå¹¶äº§ç”Ÿçš„æäº¤å¯¹è±¡æœ‰å¤šä¸ªçˆ¶å¯¹è±¡```ï¼‰


æ™®é€šçš„å•æ¬¡æäº¤
![æ™®é€šçš„å•æ¬¡æäº¤](./assets/WX20200713-155925@2x.png)

ç”±åˆ†æ”¯åˆå¹¶çš„äº§ç”Ÿæäº¤å¯¹è±¡å¤šä¸ªçˆ¶å¯¹è±¡
![åˆ†æ”¯åˆå¹¶çš„æäº¤å¯¹è±¡](./assets/WX20200713-160142@2x.png)

æˆ‘ä»¬å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªå·¥ä½œç›®å½•ï¼Œé‡Œé¢åŒ…å«äº†ä¸‰ä¸ªå°†è¦è¢«æš‚å­˜å’Œæäº¤çš„æ–‡ä»¶ï¼Œ ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

```bash
project
â”œâ”€â”€ LICENSE
â”œâ”€â”€ test.rb
â””â”€â”€ README.md
```
å¦‚æœæˆ‘ä»¬æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼š
```bash
$ git add README.md test.rb LICENSE # æ­¥éª¤ 1
$ git commit -m 'The initial commit of my project' # æ­¥éª¤ 2
```
å½“æ‰§è¡Œ **æ­¥éª¤ 1** æ—¶:
æš‚å­˜æ“ä½œä¼šä¸ºæ¯ä¸€ä¸ªæ–‡ä»¶è®¡ç®—æ ¡éªŒå’Œï¼ˆä½¿ç”¨ SHA-1 å“ˆå¸Œç®—æ³•ï¼‰ï¼Œç„¶åä¼šæŠŠå½“å‰ç‰ˆæœ¬çš„æ–‡ä»¶å¿«ç…§ä¿å­˜åˆ° Git ä»“åº“ä¸­ ï¼ˆGit ä½¿ç”¨ blob å¯¹è±¡æ¥ä¿å­˜å®ƒä»¬ï¼‰ï¼Œæœ€ç»ˆå°†æ ¡éªŒå’ŒåŠ å…¥åˆ°æš‚å­˜åŒºåŸŸç­‰å¾…æäº¤

å½“æ‰§è¡Œ **æ­¥éª¤ 2** æ—¶:
ç”¨ ```git commit``` è¿›è¡Œæäº¤æ“ä½œæ—¶ï¼ŒGit ä¼šå…ˆè®¡ç®—æ¯ä¸€ä¸ªå­ç›®å½•ï¼ˆæœ¬ä¾‹ä¸­åªæœ‰é¡¹ç›®æ ¹ç›®å½•ï¼‰çš„æ ¡éªŒå’Œï¼Œ ç„¶ååœ¨ Git ä»“åº“ä¸­è¿™äº›æ ¡éªŒå’Œä¿å­˜ä¸ºæ ‘å¯¹è±¡ã€‚éšåï¼ŒGit ä¾¿ä¼šåˆ›å»ºä¸€ä¸ªæäº¤å¯¹è±¡ï¼Œ å®ƒé™¤äº†åŒ…å«ä¸Šé¢æåˆ°çš„é‚£äº›ä¿¡æ¯å¤–ï¼Œè¿˜åŒ…å«æŒ‡å‘è¿™ä¸ªæ ‘å¯¹è±¡ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰çš„æŒ‡é’ˆã€‚

![](https://git-scm.com/book/en/v2/images/commit-and-tree.png)

å½“æœ‰å‡ æ¬¡æäº¤åï¼Œæäº¤å¯¹è±¡ä¹‹é—´çš„å…³ç³»é•¿è¿™æ ·:

![](https://git-scm.com/book/en/v2/images/commits-and-parents.png)

> Git çš„åˆ†æ”¯ï¼Œå…¶å®æœ¬è´¨ä¸Šä»…ä»…æ˜¯æŒ‡å‘æäº¤å¯¹è±¡çš„å¯å˜æŒ‡é’ˆã€‚ Git é¼“åŠ±åœ¨å·¥ä½œæµç¨‹ä¸­é¢‘ç¹åœ°ä½¿ç”¨åˆ†æ”¯ä¸åˆå¹¶ï¼Œå“ªæ€•ä¸€å¤©ä¹‹å†…è¿›è¡Œè®¸å¤šæ¬¡ã€‚

Note:
> Git çš„ master åˆ†æ”¯**å¹¶ä¸æ˜¯**ä¸€ä¸ªç‰¹æ®Šåˆ†æ”¯ã€‚ å®ƒå°±è·Ÿå…¶å®ƒåˆ†æ”¯å®Œå…¨æ²¡æœ‰åŒºåˆ«ã€‚ ä¹‹æ‰€ä»¥å‡ ä¹æ¯ä¸€ä¸ªä»“åº“éƒ½æœ‰ master åˆ†æ”¯ï¼Œæ˜¯å› ä¸º git init å‘½ä»¤é»˜è®¤åˆ›å»ºå®ƒï¼Œå¹¶ä¸”å¤§å¤šæ•°äººéƒ½æ‡’å¾—å»æ”¹åŠ¨å®ƒã€‚


## åˆ†æ”¯æ“ä½œ
### 1ã€åˆ›å»ºåˆ†æ”¯
```bash
$ git branch testing # åˆ›å»ºä¸€ä¸ªåå­—ä¸º testing çš„åˆ†æ”¯
```
![](https://git-scm.com/book/en/v2/images/two-branches.png)

Git åˆæ˜¯æ€ä¹ˆçŸ¥é“å½“å‰åœ¨å“ªä¸€ä¸ªåˆ†æ”¯ä¸Šå‘¢ï¼Ÿ ä¹Ÿå¾ˆç®€å•ï¼Œå®ƒæœ‰ä¸€ä¸ªåä¸º HEAD çš„ç‰¹æ®ŠæŒ‡é’ˆ
å› ä¸º ```git branch``` å‘½ä»¤ä»…ä»… åˆ›å»º ä¸€ä¸ªæ–°åˆ†æ”¯ï¼Œå¹¶ä¸ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°æ–°åˆ†æ”¯ä¸­å»ã€‚


#### HEAD çš„ç‰¹æ€§
 - HEAD æŒ‡å‘å½“å‰æ‰€åœ¨çš„åˆ†æ”¯
 ```bash
  $ git log --oneline --decorate # git log å‘½ä»¤æŸ¥çœ‹å„ä¸ªåˆ†æ”¯å½“å‰æ‰€æŒ‡çš„å¯¹è±¡
 ```
 ![](https://git-scm.com/book/en/v2/images/head-to-master.png)
 - HEAD åˆ†æ”¯éšç€æäº¤æ“ä½œè‡ªåŠ¨å‘å‰ç§»åŠ¨
 - æ£€å‡ºæ—¶ HEAD éšä¹‹ç§»åŠ¨
### 2ã€åˆ‡æ¢åˆ†æ”¯
```bash
$ git checkout testing # è¿™æ · HEAD å°± æŒ‡å‘ testing åˆ†æ”¯äº†
# æ­¤æ“ä½œåšäº†ä¸¤ä»¶äº‹æƒ…
# ä¸€æ˜¯ä½¿ HEAD æŒ‡å› testing åˆ†æ”¯
# äºŒæ˜¯å°†å·¥ä½œç›®å½•æ¢å¤æˆ testing åˆ†æ”¯æ‰€æŒ‡å‘çš„å¿«ç…§å†…å®¹
```
æ‰§è¡Œ ```git checkout testing``` ä¹‹åï¼ŒHEAD çš„æŒ‡å‘
![](https://git-scm.com/book/en/v2/images/head-to-testing.png)

> Tips: åˆ›å»ºå¹¶ä¸”åˆ‡æ¢åˆ°æ–°åˆ†æ”¯: é€šå¸¸æˆ‘ä»¬ä¼šåœ¨åˆ›å»ºä¸€ä¸ªæ–°åˆ†æ”¯åç«‹å³åˆ‡æ¢è¿‡å»  ``` git checkout -b branchName```

### 3ã€åˆ é™¤åˆ†æ”¯
```bash
$ git branch -d branchName # åˆ é™¤æœ¬åœ°åˆ†æ”¯ï¼Œå®‰å…¨æ“ä½œ
$ git branch -D branchName # å¼ºåˆ¶æœ¬åœ°åˆ é™¤åˆ†æ”¯, !!! å±é™©æ“ä½œ
```

### 4ã€æ¸…ç†åˆ†æ”¯:
åˆ é™¤è¿œç¨‹åˆ†æ”¯æ—¶ï¼Œæœ‰æ—¶ä¼šé‡åˆ°é—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™éœ€è¦æ¸…ç†æœ¬åœ°åˆ†æ”¯ä¿¡æ¯çš„ç¼“å­˜ï¼Œæ‰§è¡Œï¼š 
```bash
$ git fetch --prune origin
$ # å¯ä»¥ç®€å†™æˆ git fetch -p origin
```

### 4ã€åˆå¹¶åˆ†æ”¯
> åˆå¹¶åˆ†æ”¯æœ‰ 2 ç§æ–¹æ³•ï¼šä½¿ç”¨ merge æˆ– rebase

#### ä½¿ç”¨ merge åˆå¹¶

- ##### Fast-Forward åˆå¹¶(å¿«è¿›åˆå¹¶)

å‡è®¾ ç›®å‰çš„åˆ†æ”¯æƒ…å†µæ˜¯è¿™æ ·çš„ï¼šæˆ‘ä»¬åœ¨ hotifx åˆ†æ”¯é‡Œ ä¿®å¤äº†ä¸€ä¸ª bug, å¹¶ä¸”æäº¤äº†ä¸€æ¬¡

![](https://git-scm.com/book/en/v2/images/basic-branching-4.png)

æ­¤æ—¶ï¼Œæˆ‘ä»¬è¦æŠŠ ä¿®å¤çš„ bug ä¸Šçº¿ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦ æŠŠ hotfix åˆå¹¶åˆ° master åˆ†æ”¯ä¸Š.

```bash
$ git checkout master
$ git merge hotfix
```

ç„¶åï¼Œåˆ†æ”¯çš„æƒ…å†µå°±å˜æˆè¿™æ ·å­äº†

![](https://git-scm.com/book/en/v2/images/basic-branching-5.png)

- ##### ä¸‰æ–¹åˆå¹¶(åŸºæœ¬åˆå¹¶)

ä¸‰æ–¹åˆå¹¶æ —å­ï¼š
å‡è®¾ æ­¤æ—¶çš„åˆ†æ”¯æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬è¦æŠŠ iss53 çš„åˆ†æ”¯ åˆå¹¶åˆ° master ä¸Š

![](https://git-scm.com/book/en/v2/images/basic-branching-6.png)

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ çš„å¼€å‘å†å²ä»ä¸€ä¸ªæ›´æ—©çš„åœ°æ–¹å¼€å§‹åˆ†å‰å¼€æ¥ï¼ˆdivergedï¼‰ã€‚ å› ä¸ºï¼Œmaster åˆ†æ”¯æ‰€åœ¨æäº¤å¹¶ä¸æ˜¯ iss53 åˆ†æ”¯æ‰€åœ¨æäº¤çš„ç›´æ¥ç¥–å…ˆã€‚å‡ºç°è¿™ç§æƒ…å†µçš„æ—¶å€™ï¼ŒGit éœ€è¦åšä¸€äº›é¢å¤–çš„å·¥ä½œã€‚ Git ä¼šä½¿ç”¨ä¸¤ä¸ªåˆ†æ”¯çš„æœ«ç«¯æ‰€æŒ‡çš„å¿«ç…§ï¼ˆC4 å’Œ C5ï¼‰ä»¥åŠè¿™ä¸¤ä¸ªåˆ†æ”¯çš„å…¬å…±ç¥–å…ˆï¼ˆC2ï¼‰ï¼Œåšä¸€ä¸ªç®€å•çš„```ä¸‰æ–¹åˆå¹¶```

![](https://git-scm.com/book/en/v2/images/basic-merging-1.png)

```bash
$ git checkout master
$ git merge iss53
```

åˆå¹¶ä¹‹åçš„æ•ˆæœï¼š


![](https://git-scm.com/book/en/v2/images/basic-merging-2.png)

åœ¨è¿›è¡Œåˆ†æ”¯åˆå¹¶çš„æ—¶å€™ï¼Œå¦‚æœæ¡ä»¶å…è®¸çš„è¯ï¼ŒGit ä¼šé»˜è®¤å…ˆè¿›è¡Œå¿«é€Ÿåˆå¹¶(å¦‚æœ git merge æ²¡æœ‰æŒ‡å®š --no-ff)ã€‚

åœ¨ä¸èƒ½è¿›è¡Œå¿«é€Ÿåˆå¹¶çš„æƒ…å†µä¸‹ï¼Œ Git åˆ†æ”¯ ä¼šè‡ªåŠ¨è¿›è¡Œä¸‰æ–¹åˆå¹¶ã€‚

##### å¸¦å‚æ•°çš„ ```git merge```

- **git merge â€“no-ff** ï¼ˆno fast fowardï¼‰

  ```--no-ff```çš„æ„æ€æ˜¯å…³é—­ ```fast-forward``` æ–¹å¼
è¿›è¡Œåˆå¹¶æ—¶ï¼Œä½¿å¾—æ¯ä¸€æ¬¡çš„åˆå¹¶éƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„ ```commit``` è®°å½•ã€‚å³ä½¿è¿™ä¸ª ```commit``` æœ¬æ¥å¯ä»¥æ˜¯  ```fast-foward``` ç”¨æ¥é¿å…ä¸¢å¤±ä¿¡æ¯ã€‚

-  **git merge --squash**
åœ¨åˆå¹¶æ—¶ä¸€äº›ä¸å¿…è¦ ```commit``` è¿›è¡Œå‹ç¼©ï¼Œæ¯”å¦‚è¯´ï¼Œä½ çš„ ```feature ```åœ¨å¼€å‘çš„æ—¶å€™å†™çš„   ```commit``` å¾ˆä¹±ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆå¹¶çš„æ—¶å€™ä¸å¸Œæœ›æŠŠè¿™äº›å†å² ```commit``` å¸¦è¿‡æ¥ï¼Œäºæ˜¯ä½¿ç”¨``` --squash ```è¿›è¡Œåˆå¹¶ï¼Œæ­¤æ—¶æ–‡ä»¶å·²ç»åŒåˆå¹¶åä¸€æ ·äº†ï¼Œä½†ä¸ç§»åŠ¨  ```HEAD```ï¼Œä¸æäº¤ã€‚éœ€è¦è¿›è¡Œä¸€æ¬¡é¢å¤–çš„ ```commit ```æ¥â€œæ€»ç»“â€ä¸€ä¸‹ï¼Œç„¶åå®Œæˆæœ€ç»ˆçš„åˆå¹¶ã€‚


eg::pencil: ä¸¾ä¾‹å­-æ¼”ç¤º

```
$ git merge --no-ff -m "merge with no-ff" develop 
# æœ¬æ¬¡åˆå¹¶è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ commitï¼Œæ‰€ä»¥åŠ ä¸Š -m å‚æ•°ï¼ŒæŠŠ commit æè¿°å†™è¿›å»ã€‚
```


##### æ€»ç»“ï¼š

- --no-ffï¼šä¸ä½¿ç”¨ ```fast-forward``` æ–¹å¼åˆå¹¶ï¼Œä¿ç•™åˆ†æ”¯çš„ ```commit``` å†å²ï¼Œä¸”ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤å¯¹è±¡.
- --squashï¼šä½¿ç”¨ ```squash``` æ–¹å¼åˆå¹¶ï¼ŒæŠŠå¤šæ¬¡åˆ†æ”¯ ```commit``` å†å²å‹ç¼©ä¸ºä¸€æ¬¡

ä¸€ä¸ªå¾ˆç›´è§‚çš„å›¾ï¼š

![](https://image-static.segmentfault.com/120/030/1200301748-54c88abc9ed57_articlex)


##### è§£å†³åˆ†æ”¯åˆå¹¶æ—¶çš„å†²çª

```bash
<<<<<<< HEAD:index.html
<div id="footer">contact : email.support@github.com</div>
=======
<div id="footer">
 please contact us at support@github.com
</div>
>>>>>>> iss53:index.html
```

è¿™é‡Œ  è¡¨ç¤º ```HEAD``` æ‰€æŒ‡ç¤ºçš„ç‰ˆæœ¬ï¼ˆä¹Ÿå°±æ˜¯ä½ å½“å‰åˆ†æ”¯æ‰€åœ¨çš„ä½ç½®ï¼Œå› ä¸ºä½ åœ¨è¿è¡Œ ```merge``` å‘½ä»¤çš„æ—¶å€™å·²ç»æ£€å‡ºåˆ°äº†è¿™ä¸ªåˆ†æ”¯ï¼‰åœ¨è¿™ä¸ªåŒºæ®µçš„ä¸ŠåŠéƒ¨åˆ†ï¼ˆ======= çš„ä¸ŠåŠéƒ¨åˆ†ï¼‰ï¼Œè€Œ ```iss53``` åˆ†æ”¯æ‰€æŒ‡ç¤ºçš„ç‰ˆæœ¬åœ¨ ======= çš„ä¸‹åŠéƒ¨åˆ†ã€‚ ä¸ºäº†è§£å†³å†²çªï¼Œä½ å¿…é¡»é€‰æ‹©ä½¿ç”¨ç”± ======= åˆ†å‰²çš„ä¸¤éƒ¨åˆ†ä¸­çš„ä¸€ä¸ªï¼Œæˆ–è€…ä½ ä¹Ÿå¯ä»¥è‡ªè¡Œåˆå¹¶è¿™äº›å†…å®¹ã€‚ ä¾‹å¦‚ï¼Œä½ å¯ä»¥é€šè¿‡æŠŠè¿™æ®µå†…å®¹æ¢æˆä¸‹é¢çš„æ ·å­æ¥è§£å†³å†²çªï¼š

```bash
<div id="footer">
please contact us at email.support@github.com
</div>
```
ä¸Šè¿°çš„å†²çªè§£å†³æ–¹æ¡ˆä»…ä¿ç•™äº†å…¶ä¸­ä¸€ä¸ªåˆ†æ”¯çš„ä¿®æ”¹ï¼Œå¹¶ä¸” <<<<<<< , ======= , å’Œ >>>>>>> è¿™äº›è¡Œè¢«å®Œå…¨åˆ é™¤äº†ã€‚ åœ¨ä½ è§£å†³äº†æ‰€æœ‰æ–‡ä»¶é‡Œçš„å†²çªä¹‹åï¼Œå¯¹æ¯ä¸ªæ–‡ä»¶ä½¿ç”¨ ```git add``` å‘½ä»¤æ¥å°†å…¶æ ‡è®°ä¸ºå†²çªå·²è§£å†³ã€‚ ä¸€æ—¦æš‚å­˜è¿™äº›åŸæœ¬æœ‰å†²çªçš„æ–‡ä»¶ï¼ŒGit å°±ä¼šå°†å®ƒä»¬æ ‡è®°ä¸ºå†²çªå·²è§£å†³ã€‚

VSCode å†²çªæ–‡ä»¶å›¾å½¢ç•Œé¢æ˜¾ç¤ºå¦‚ä¸‹ï¼š

![](./assets/WX20200713-214042@2x.png)
> ps: å»ºè®®ï¼šæ¨èä½¿ç”¨ IDE è‡ªå¸¦çš„ Git å›¾å½¢åŒ–ç•Œé¢è§£å†³å†²çªã€‚å¯¹äºä¸æ˜¯è‡ªå·±å†™çš„ä»£ç ï¼Œåœ¨æ²¡æœ‰æŠŠæ¡çš„æ—¶å€™ï¼Œæ‰¾åˆ°ä½œè€…ä¸€èµ·è§£å†³å†²çªã€‚


ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½ä½¿ç”¨ä¸å¸¦ å‚æ•°çš„ git merge å³å¯ã€‚

### åˆå¹¶æœ¯è¯­çš„è®¨è®º:
> å½“æˆ‘ä»¬è¯´ a åˆ†æ”¯ åˆå¹¶ b åˆ†æ”¯çš„æ—¶å€™ï¼Œå¯¹æ–¹çœŸçš„æ˜ç™½ æˆ‘çš„æ„æ€å— ï¼Ÿï¼Ÿ

- åˆ†æ”¯åˆå¹¶æœ¯è¯­çš„ç»Ÿä¸€
- å›¢é˜Ÿé‡Œçš„æˆå‘˜èƒ½æ˜ç™½ï¼Œä¸ä¼šæœ‰æ­§ä¹‰ã€‚
- è¾¾æˆå…±è¯†


## git rebase

### ä½¿ç”¨å˜åŸºåˆå¹¶åˆ†æ”¯

å‡è®¾ç›®å‰çš„åˆ†æ”¯æƒ…å†µæ˜¯å¦‚ä¸‹çš„ï¼š

![](https://git-scm.com/book/en/v2/images/basic-rebase-1.png)

æ­¤æ—¶ï¼Œæˆ‘ä»¬è¦æŠŠ ```experiment``` åˆ†æ”¯åˆå¹¶åˆ° ```master``` åˆ†æ”¯ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ merge, ä¹Ÿå¯ä»¥ ä½¿ç”¨ ```rebase```

> ä½¿ç”¨ rebase å‘½ä»¤å°†æäº¤åˆ°æŸä¸€åˆ†æ”¯ä¸Šçš„æ‰€æœ‰ä¿®æ”¹éƒ½ç§»è‡³å¦ä¸€åˆ†æ”¯ä¸Šï¼Œå°±å¥½åƒâ€œé‡æ–°æ’­æ”¾â€ä¸€æ ·ï¼Œ è¿™ç§æ“ä½œå«åšå˜åŸºã€‚

```bash
$ git checkout experiment
$ git rebase  master
# æˆ–è€… ç›´æ¥ä½¿ç”¨ ä¸€æ¡å‘½ä»¤ï¼š
$ git rebase <basebranch> <topicbranch> 
# æ­¤å‘½ä»¤å¯ä»¥ç›´æ¥å°†ä¸»é¢˜åˆ†æ”¯ ï¼ˆå³æœ¬ä¾‹ä¸­çš„ ï¼‰å˜åŸºåˆ°ç›®æ ‡åˆ†æ”¯ï¼ˆå³ masterï¼‰
$ git rebase master experiment
```
å˜åŸºåï¼š

![](https://git-scm.com/book/en/v2/images/basic-rebase-3.png)

å®ƒçš„åŸç†æ˜¯é¦–å…ˆæ‰¾åˆ°è¿™ä¸¤ä¸ªåˆ†æ”¯ï¼ˆå³å½“å‰åˆ†æ”¯ ```experiment```ã€å˜åŸºæ“ä½œçš„ç›®æ ‡åŸºåº•åˆ†æ”¯ ```master```ï¼‰ çš„æœ€è¿‘å…±åŒç¥–å…ˆ C2ï¼Œç„¶åå¯¹æ¯”å½“å‰åˆ†æ”¯ç›¸å¯¹äºè¯¥ç¥–å…ˆçš„å†æ¬¡æäº¤ï¼Œæå–ç›¸åº”çš„ä¿®æ”¹å¹¶å­˜ä¸ºä¸´æ—¶æ–‡ä»¶ï¼Œ ç„¶åå°†å½“å‰åˆ†æ”¯æŒ‡å‘ç›®æ ‡åŸºåº• C3, æœ€åä»¥æ­¤å°†ä¹‹å‰å¦å­˜ä¸ºä¸´æ—¶æ–‡ä»¶çš„ä¿®æ”¹ä¾åºåº”ç”¨ã€‚

ç°åœ¨å›åˆ° ```master``` åˆ†æ”¯ï¼Œè¿›è¡Œä¸€æ¬¡å¿«è¿›åˆå¹¶ã€‚

```bash
$ git checkout master
$ git merge experiment
```

![](https://git-scm.com/book/en/v2/images/basic-rebase-4.png)

eg::pencil: ä¸¾ä¾‹å­-æ¼”ç¤º


é€šè¿‡å˜åŸºï¼Œæˆ‘ä»¬å®Œæˆäº†åˆ†æ”¯åˆå¹¶æ“ä½œï¼Œå¹¶ä¸”åˆ†æ”¯çœ‹èµ·æ¥æ›´èˆ’æœã€‚ç‰¹åˆ«æ˜¯å¤šäººåä½œå¼€å‘æ—¶ï¼Œåˆ†æ”¯ä¸ä¼šæœ‰å¾ˆå¤šäº¤å‰ï¼Œåˆ†æ”¯æ›´åŠ æ¸…æ™°ã€‚

> è¯·æ³¨æ„ï¼Œæ— è®ºæ˜¯é€šè¿‡å˜åŸºï¼Œè¿˜æ˜¯é€šè¿‡ä¸‰æ–¹åˆå¹¶ï¼Œæ•´åˆçš„æœ€ç»ˆç»“æœæ‰€æŒ‡å‘çš„å¿«ç…§å§‹ç»ˆæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡æäº¤å†å²ä¸åŒç½¢äº†ã€‚ å˜åŸºæ˜¯å°†ä¸€ç³»åˆ—æäº¤æŒ‰ç…§åŸæœ‰æ¬¡åºä¾æ¬¡åº”ç”¨åˆ°å¦ä¸€åˆ†æ”¯ä¸Šï¼Œè€Œåˆå¹¶æ˜¯æŠŠæœ€ç»ˆç»“æœåˆåœ¨ä¸€èµ·ã€‚ä¸€èˆ¬æˆ‘ä»¬è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿åœ¨å‘è¿œç¨‹åˆ†æ”¯æ¨é€æ—¶èƒ½ä¿æŒæäº¤å†å²çš„æ•´æ´

æ€è€ƒï¼šğŸ¤” æ—¢ç„¶ ```git rebase``` è¿™ä¹ˆå¥½ç”¨, é‚£ä¹ˆæ˜¯ä¸æ˜¯ä»¥åçš„åˆ†æ”¯åˆå¹¶å°±ç›´æ¥ ç”¨ ```git rebase``` äº†å‘¢ï¼Ÿ


æœ€ä½³å®è·µï¼š

> å¦‚æœæäº¤å­˜åœ¨äºä½ çš„ä»“åº“ä¹‹å¤–ï¼Œè€Œåˆ«äººå¯èƒ½åŸºäºè¿™äº›æäº¤è¿›è¡Œå¼€å‘ï¼Œé‚£ä¹ˆä¸è¦æ‰§è¡Œå˜åŸºã€‚æ¢å¥è¯è¯´ï¼Œåªå¯¹æœ¬åœ°è¿˜æœªæ¨é€åˆ°è¿œç«¯ä»“åº“çš„ æäº¤è¿›è¡Œ å˜åŸºã€‚

å¦‚æœä½ éµå¾ªè¿™æ¡é‡‘ç§‘ç‰å¾‹ï¼Œå°±ä¸ä¼šå‡ºå·®é”™ã€‚ å¦åˆ™ï¼Œäººæ°‘ç¾¤ä¼—ä¼šä»‡æ¨ä½ ï¼Œä½ çš„æœ‹å‹å’Œå®¶äººä¹Ÿä¼šå˜²ç¬‘ä½ ï¼Œå”¾å¼ƒä½ ã€‚

å¯¹è¿œç¨‹åˆ†æ”¯è¿›è¡Œå˜åŸºå¸¦æ¥çš„é—®é¢˜ï¼š å¯èƒ½ä¼šå‘ç°æœ‰å¤šä¸ªæäº¤çš„ä½œè€…ã€æ—¥æœŸã€æ—¥å¿—å±…ç„¶æ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¼šä»¤äººæ„Ÿåˆ°æ··ä¹±ã€‚




(åŒ…å« git rebase -i)


#### å˜åŸº vs. åˆå¹¶

å­¦ä¹ äº†å˜åŸºå’Œåˆå¹¶çš„ç”¨æ³•ï¼Œä½ ä¸€å®šä¼šæƒ³é—®ï¼Œåˆ°åº•å“ªç§æ–¹å¼æ›´å¥½

æœ‰ä¸€ç§è§‚ç‚¹è®¤ä¸ºï¼Œä»“åº“çš„æäº¤å†å²å³æ˜¯ è®°å½•å®é™…å‘ç”Ÿè¿‡ä»€ä¹ˆã€‚ å®ƒæ˜¯é’ˆå¯¹å†å²çš„æ–‡æ¡£ï¼Œæœ¬èº«å°±æœ‰ä»·å€¼ï¼Œä¸èƒ½ä¹±æ”¹ã€‚ ä»è¿™ä¸ªè§’åº¦çœ‹æ¥ï¼Œæ”¹å˜æäº¤å†å²æ˜¯ä¸€ç§äºµæ¸ï¼Œä½ ä½¿ç”¨ è°è¨€ æ©ç›–äº†å®é™…å‘ç”Ÿè¿‡çš„äº‹æƒ…ã€‚ å¦‚æœç”±åˆå¹¶äº§ç”Ÿçš„æäº¤å†å²æ˜¯ä¸€å›¢ç³Ÿæ€ä¹ˆåŠï¼Ÿ æ—¢ç„¶äº‹å®å°±æ˜¯å¦‚æ­¤ï¼Œé‚£ä¹ˆè¿™äº›ç—•è¿¹å°±åº”è¯¥è¢«ä¿ç•™ä¸‹æ¥ï¼Œè®©åäººèƒ½å¤ŸæŸ¥é˜…ã€‚

å¦ä¸€ç§è§‚ç‚¹åˆ™æ­£å¥½ç›¸åï¼Œä»–ä»¬è®¤ä¸ºæäº¤å†å²æ˜¯ é¡¹ç›®è¿‡ç¨‹ä¸­å‘ç”Ÿçš„äº‹ã€‚ æ²¡äººä¼šå‡ºç‰ˆä¸€æœ¬ä¹¦çš„ç¬¬ä¸€ç‰ˆè‰ç¨¿ï¼Œè½¯ä»¶ç»´æŠ¤æ‰‹å†Œä¹Ÿæ˜¯éœ€è¦åå¤ä¿®è®¢æ‰èƒ½æ–¹ä¾¿ä½¿ç”¨ã€‚

> æ€»çš„åŸåˆ™æ˜¯ï¼Œåªå¯¹å°šæœªæ¨é€æˆ–åˆ†äº«ç»™åˆ«äººçš„æœ¬åœ°ä¿®æ”¹æ‰§è¡Œå˜åŸºæ“ä½œæ¸…ç†å†å²ï¼Œ ä»ä¸å¯¹å·²æ¨é€è‡³åˆ«å¤„çš„æäº¤æ‰§è¡Œå˜åŸºæ“ä½œ

æ ¹æ®å®é™…æƒ…å†µä½œå‡ºæ˜æ™ºçš„é€‰æ‹©ã€‚

è‡ªå·±çš„æ“ä½œä¹ æƒ¯ï¼š

- å¯¹äºå•ç‹¬çš„è¿­ä»£åˆ†æ”¯ï¼Œåˆ›å»ºåŸºäºè‡ªå·±çš„ ```feature è¿­ä»£åˆ†æ”¯```ï¼Œæ­¤åˆ†æ”¯çš„éƒ¨åˆ†æˆ–è€…å…¨éƒ¨åŠŸèƒ½å¼€å‘æˆåŠŸåï¼Œ å˜åŸºåˆåˆ° å…¬å…± ```feature åˆ†æ”¯```ï¼Œå†é€šè¿‡å¿«é€Ÿåˆå¹¶ï¼Œå°† ```feature``` åˆå¹¶ è‡ªå·±çš„è¿­ä»£åˆ†æ”¯ã€‚
- å¯¹äº ```master```åˆå¹¶ ```develop```, ```develop``` åˆ†æ”¯ åˆå¹¶ ```feature``` åˆ†æ”¯ï¼Œæ€»æ˜¯ä½¿ç”¨ ```merge``` åˆå¹¶ã€‚

#### é‡å†™å†å²

##### ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤

åªæ˜¯æƒ³ä¿®æ”¹æœ€è¿‘ä¸€æ¬¡æäº¤çš„æäº¤ä¿¡æ¯

```bash
$ git commit --amend # å®ƒä¼šåˆå¹¶ä½ ç¼“å­˜åŒºçš„ä¿®æ”¹å’Œä¸Šä¸€æ¬¡commitï¼Œå¯ä»¥ç”¨æ¥ä¿®æ”¹æäº¤ä¿¡æ¯å’Œæäº¤å†…å®¹ã€‚
```

ä¸Šé¢è¿™æ¡å‘½ä»¤ä¼šå°†æœ€åä¸€æ¬¡çš„æäº¤ä¿¡æ¯è½½å…¥åˆ°ç¼–è¾‘å™¨ä¸­ä¾›ä½ ä¿®æ”¹ã€‚ å½“ä¿å­˜å¹¶å…³é—­ç¼–è¾‘å™¨åï¼Œç¼–è¾‘å™¨ä¼šå°†æ›´æ–°åçš„æäº¤ä¿¡æ¯å†™å…¥æ–°æäº¤ä¸­ï¼Œå®ƒä¼šæˆä¸ºæ–°çš„æœ€åä¸€æ¬¡æäº¤ã€‚

å¦‚æœä½ æƒ³è¦ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤çš„å®é™…å†…å®¹

é¦–å…ˆä½œå‡ºä½ æƒ³è¦è¡¥ä¸Šçš„ä¿®æ”¹ï¼Œ æš‚å­˜å®ƒä»¬ï¼Œç„¶åç”¨ ````git commit --amend``` ä»¥æ–°çš„æ”¹è¿›åçš„æäº¤æ¥ æ›¿æ¢ æ‰æ—§æœ‰çš„æœ€åä¸€æ¬¡æäº¤ã€‚

å› ä¸ºä¿®æ­£ä¼šæ”¹å˜æäº¤çš„ **SHA-1 æ ¡éªŒå’Œ**ã€‚ å®ƒç±»ä¼¼äºä¸€ä¸ªå°çš„å˜åŸºâ€”â€”å¦‚æœå·²ç»æ¨é€äº†æœ€åä¸€æ¬¡æäº¤å°±ä¸è¦ä¿®æ­£å®ƒã€‚

å¦‚æœåªæ˜¯ä¿®è¡¥æ–‡ä»¶å†…å®¹ï¼Œè€Œä¸éœ€è¦ä¿®æ­£æäº¤ä¿¡æ¯çš„è¯ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤é¿å…ä¸å¿…è¦çš„ç¼–è¾‘å™¨ç¯èŠ‚
å‡è®¾ä¿®è¡¥çš„æ–‡ä»¶ åä¸º xxxx, å®Œæˆä¿®æ”¹åï¼š

```bash
$ git add xxxx
$ git commit --amend --no-edit
```

eg::pencil: ä¸¾ä¾‹å­-æ¼”ç¤º

> Tipsï¼š ä¿®è¡¥æäº¤ä¹‹åï¼Œç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„æäº¤å¯¹è±¡ã€‚æ—§çš„æäº¤å¯¹è±¡å°±æ‰¾ä¸åˆ°äº†ã€‚æ‰€ä»¥ï¼Œå°½é‡ä¸è¦å¯¹å·²ç»æäº¤åˆ°è¿œç¨‹ä»“åº“çš„æäº¤è¿›è¡Œä¿®è¡¥ã€‚


##### ä¿®æ”¹å¤šä¸ªæäº¤ä¿¡æ¯
```git rebase -i``` è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå˜åŸºå‘½ä»¤ -i (interactive)

å¯ä»¥é€šè¿‡ç»™ **git rebase å¢åŠ  -i** é€‰é¡¹æ¥äº¤äº’å¼åœ°è¿è¡Œå˜åŸº

eg: å¦‚æœæƒ³è¦ä¿®æ”¹æœ€è¿‘ä¸‰æ¬¡æäº¤ä¿¡æ¯ï¼Œæˆ–è€…é‚£ç»„æäº¤ä¸­çš„ä»»æ„ä¸€ä¸ªæäº¤ä¿¡æ¯

```bash
$ git rebase -i HEAD~3
```
è¿è¡Œè¿™ä¸ªå‘½ä»¤ä¼šåœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸Šç»™ä½ ä¸€ä¸ªæäº¤çš„åˆ—è¡¨ï¼Œçœ‹èµ·æ¥åƒä¸‹é¢è¿™æ ·ï¼š

![](./assets/WX20200714-104417@2x.png)

é‡ç‚¹æ³¨æ„çš„æ˜¯ç›¸å¯¹äºæ­£å¸¸ä½¿ç”¨çš„ log å‘½ä»¤ï¼Œè¿™äº›æäº¤æ˜¾ç¤ºçš„é¡ºåºæ˜¯ç›¸åçš„ã€‚

è¿è¡Œä¸€æ¬¡ log å‘½ä»¤ï¼ŒæŸ¥çœ‹ç›®å‰çš„æäº¤ä¿¡æ¯ï¼š
```bash
$ git log --pretty=format:"%h %s" HEAD~3..HEAD
```
- é‡æ–°æ’åºæäº¤

å‡è®¾ç›®å‰æ˜¾ç¤ºçš„ä¿¡æ¯æ˜¯è¿™æ ·çš„ï¼š
```bash
pick f7f3f6d changed my name a bit
pick 310154e updated README formatting and added blame
pick a5f4a0d added cat-file
```
å¦‚æœæƒ³è¦ç§»é™¤ â€œadded cat-fileâ€ æäº¤ç„¶åä¿®æ”¹å¦å¤–ä¸¤ä¸ªæäº¤å¼•å…¥çš„é¡ºåºï¼Œå¯ä»¥å°†å˜åŸºè„šæœ¬ä»è¿™æ ·ï¼š

æ”¹ä¸ºè¿™æ ·ï¼š

```bash
pick 310154e updated README formatting and added blame
pick f7f3f6d changed my name a bit
```
å½“ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨æ—¶ï¼ŒGit å°†ä½ çš„åˆ†æ”¯å¸¦å›è¿™äº›æäº¤çš„çˆ¶æäº¤ï¼Œåº”ç”¨ 310154e ç„¶ååº”ç”¨ f7f3f6dï¼Œæœ€ååœæ­¢ã€‚ äº‹å®ä¿®æ”¹äº†é‚£äº›æäº¤çš„é¡ºåºå¹¶å®Œå…¨åœ°ç§»é™¤äº† â€œadded cat-fileâ€ æäº¤ã€‚

eg::pencil: ä¸¾ä¾‹å­-æ¼”ç¤º

- å‹ç¼©æäº¤

é€šè¿‡äº¤äº’å¼å˜åŸºå·¥å…·ï¼Œä¹Ÿå¯ä»¥å°†ä¸€è¿ä¸²æäº¤å‹ç¼©æˆä¸€ä¸ªå•ç‹¬çš„æäº¤ã€‚

åŠ¨å›¾æ¼”ç¤ºï¼š

```bash
pick f7f3f6d changed my name a bit
squash 310154e updated README formatting and added blame
squash a5f4a0d added cat-file
```

![](https://dev-to-uploads.s3.amazonaws.com/i/bc1r460xx1i0blu0lnnm.gif)

å½“ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘å™¨æ—¶ï¼ŒGit åº”ç”¨æ‰€æœ‰çš„ä¸‰æ¬¡ä¿®æ”¹ç„¶åå°†ä½ æ”¾åˆ°ç¼–è¾‘å™¨ä¸­æ¥åˆå¹¶ä¸‰æ¬¡æäº¤ä¿¡æ¯ï¼š

eg::pencil: ä¸¾ä¾‹å­-æ¼”ç¤º

äº¤äº’å¼å˜åŸº å‘½ä»¤ï¼š

```bash
# p, pick <commit> = use commit
# r, reword <commit> = use commit, but edit the commit message
# e, edit <commit> = use commit, but stop for amending
# s, squash <commit> = use commit, but meld into previous commit
# f, fixup <commit> = like "squash", but discard this commit's log message
# d, drop <commit> = remove commit
# l, label <label> = label current HEAD with a name
# t, reset <label> = reset HEAD to a label
# m, merge [-C <commit> | -c <commit>] <label> [# <oneline>]
```

#### å˜åŸºæ“ä½œæ€»ç»“ï¼š 
1. **ä¸è¦**å¯¹å·²ç»æ¨é€åˆ°è¿œç¨‹çš„æäº¤è¿›è¡Œå˜åŸº(åªå¯¹æœ¬åœ°çš„æäº¤è¿›è¡Œå˜åŸº)
2. å¤š **commit**, å°‘ **push**



#### git revert å›æ»šæ“ä½œ

```bash
$ git revert HEAD # åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤,ä½¿å¾—ä»£ç å›æ»šåˆ° ä¸Šä¸€æ¬¡æäº¤å‰çš„çŠ¶æ€ã€‚
```

eg::pencil: ä¸¾ä¾‹å­-æ¼”ç¤º

#### revert VS reset
- git revert åå¤šå‡ºä¸€æ¡ commit ï¼Œæé†’çœ‹çš„äººï¼Œè¿™é‡Œæœ‰å›æ’¤æ“ä½œ
- git reset ç›´æ¥ç‰ˆä¹‹å‰ commit åˆ æ‰

### æ›´å¤šæ“ä½œ

```bash

# ç»ˆæ­¢/ç»§ç»­ åˆ†æ”¯åˆå¹¶
$ git merge --abort # ç»ˆæ­¢
$ git merge --continue # ç»§ç»­

# ç»ˆæ­¢/ç»§ç»­ å˜åŸºï¼š
$ git rebase --abort # ç»ˆæ­¢
$ git rebase --continue # ç»§ç»­

# ç»ˆæ­¢/ç»§ç»­ revert

$ git revert --abort
$ git revert --continue

# æ–°å»ºåˆ†æ”¯ï¼š

# åŸºäºå½“å‰åˆ†æ”¯ï¼Œåˆ›å»ºæ–°çš„åˆ†æ”¯ï¼š

$ git branch <branchName> # åˆ›å»ºæ–°çš„åˆ†æ”¯
$ git checkout <branchName> # åˆ‡æ¢åˆ° æŒ‡å®šåˆ†æ”¯
$ git checkout -b <branchName> # åˆ›å»ºæ–°åˆ†æ”¯ï¼Œå¹¶ä¸”åˆ‡æ¢åˆ°æ–°çš„åˆ†æ”¯

# åŸºäºæŒ‡å®šåˆ†æ”¯ï¼Œåˆ›å»ºæ–°çš„åˆ†æ”¯ï¼š

$ git checkout -b <branchName> <baseBranchName>

$  git checkout -b dev-test develop  # åŸºäº develop åˆ†æ”¯ åˆ›å»ºä¸€ä¸ª æ–°çš„ dev-test åˆ†æ”¯ï¼Œå¹¶ä¸”åˆ‡æ¢åˆ°è¿™ä¸ªåˆ†æ”¯ä¸Š

# åŸºäºæŸä¸€æ¬¡æäº¤ï¼Œåˆ›å»ºæ–°çš„åˆ†æ”¯ï¼š

$ git branch <branchName>  c6e1e95

æŸ¥çœ‹åˆ†æ”¯ï¼š

$ git branch
$ git branch -r # æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯
$ git branch -a # æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯
$ git branch -v  # å¦‚æœéœ€è¦æŸ¥çœ‹æ¯ä¸€ä¸ªåˆ†æ”¯çš„æœ€åä¸€æ¬¡æäº¤
$ git branch --merged # æŸ¥çœ‹å“ªäº›åˆ†æ”¯å·²ç»åˆå¹¶åˆ°å½“å‰åˆ†æ”¯
$ git branch --no-merged # æŸ¥çœ‹å“ªäº›åˆ†æ”¯å°šæœªåˆå¹¶åˆ°å½“å‰åˆ†æ”¯
```


#### å‚è€ƒèµ„æ–™
[Git Commit emoji Guide Gitæäº¤æ³¨é‡Šä½¿ç”¨è¡¨æƒ…æŒ‡åŒ—](https://hooj0.github.io/git-emoji-guide/)

[linux-vim-vi-å¸¸ç”¨å¿«æ·é”®åŠä½¿ç”¨æŠ€å·§](https://justcode.ikeepstudying.com/2017/12/linux-vim-vi-%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/)